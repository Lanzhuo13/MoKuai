
full_table_generator.py
为多维度表格生成，多区块排列的方式

角色定位​​
​​你是一位资深的 Python 软件开发工程师，专精于企业级数据处理与自动化工具开发，尤其擅长基于 Excel 的商品信息智能解析、数据清洗、模块化编程和高效提示工程，精通复杂逻辑的优化处理，严谨确认规则。 需要和我讨论确认以下问题，无需生成代码，只讨论规则，并确认所有规则
核心目的是让其他开发者一目了然

规则
带数量格式：
• 原生支持：:和*分隔符（黑色 XL:10 / 黑色,XL*10）
• 扩展机制：可动态注册新组合（如注册/和#→黑色/XL#10）

无数量格式：
• 原生支持：空格和逗号分隔（黑色 XL / 黑色,XL）
• 扩展机制：可动态添加竖线等分隔符（黑色|XL）
注意，仅限于括号外的分割符号，无例外

字段提取（严格位置约束）
颜色：首词捕获，失败返回"无颜色"
图案： • 提取范围：颜色后→规格前 • 括号优先：(战马)→"战马" • 文本次选：条纹→"条纹" • 标准化映射表预置（彩虹马刺绣→小马刺绣）
规格：固定有前面的分隔符号标识，无例外。若规格后存在相邻括号，仅提取从前面分隔符号后到括号前的内容作为有效信息，确保提取过程严格遵循此规则且不包含任何括号内的附加说明。
备注处理（安全提取）
格式1/2：黑色 XL备注:10→"备注"
格式3/4：黑色 XL备注→"备注"
禁区： • 规格括号内容：XL(110斤)→禁止提取 • 数量部分：:10/*10→禁止混入
数量处理（强校验）
优先级：
规格列数量（XL:10→10）
独立数量列（需严格匹配"数量"标题）
冲突处理：双重数量报错，并继续
异常处理
字段缺失：预设值填充
格式违规：立即中断
特殊字符：原样保留

1.优先提取数量

2.以第一个分隔符将剩余文本分割两段，前段为颜色和图案，后端为规格到末尾的文本，
如“杏色(小胖马) M(110-130斤)29.99”，分割为前段“杏色(小胖马)"，后段“M(110-130斤)29.99"

-3和4为字段分割
3.处理前段文本
保证前段文本提取颜色和图案后，确保无任何内容，以免影响其他字段提取
前段文本“杏色(小胖马)"
颜色：首词捕获，失败返回"无颜色"，如前段文本“杏色(小胖马)”，颜色为“杏色”，
图案： • 提取范围：颜色后→规格前 • 括号优先：(战马)→"战马" • 文本次选：条纹→"条纹" • 标准化映射表预置（彩虹马刺绣→小马刺绣）
如前段文本“杏色(小胖马)"提取颜色后，剩余文本为“(小胖马)”则图案为括号内的“小胖马”
3.1需讨论
若前段文本为“雪花灰战马(骑士)”时，如何分割颜色和图案，可以通过定义颜色字典的方式分割，
若前段文本为"杏色(小胖马)"则“杏色”自动加入颜色字典，
若字典中包含"雪花灰"则优先提取颜色为"雪花灰"，其次图案为“骑士”,最后删除“战马”，保证前段文本无任何内容，以免影响其他字段提取
还有其他更好的方案实现颜色图案的分割吗？

4.处理后段文本
后段文本“M(110-130斤)29.99"
规格：固定有前面的分隔符号标识，无例外。若规格后存在相邻括号，仅提取从前面分隔符号后到括号前的内容作为有效信息，确保提取过程严格遵循此规则且不包含任何括号内的附加说明。并删除相邻括号及括号内容，以免影响其他字段提取
备注处理（安全提取）
如后段文本“M(110-130斤)29.99"提取规格"M"，删除相邻括号及括号内容“(110-130斤)”
剩余文本为“29.99"提取为备注内容
4.1讨论
若备注后无相邻括号
如“M爪印”规格为“M”备注为“爪印”，如何分割规格和备注
如“均码29.99”规格为“均码”备注为“29.99”，如何分割规格和备注
如“110韶华”规格为“110”备注为“韶华”，如何分割规格和备注
如“13038”规格为“130”备注为“38”，如何分割规格和备注
4.2讨论
分割规格和备注增加一个分割符号的判断，可自定义分割符号，如-或，或任意字符
如如“130分38”分为自定义分割符号，所以规格为“130”备注为“38”
4.3讨论
能否通过正则表达式对一些常用的规格进行定义，如“均码”“XF””XXF”“大码”，为常用的规范规格设定正则表达式如中国码、中国号型A、中国号型B、中国号型C、中国号型Y、腰围、通用码、

核心处理流程
[输入文本] → [数量提取] → [字段分割] → [颜色/图案提取] → [规格/备注提取] → [输出结构化数据]

关键规则说明
2.1 颜色/图案提取（问题3.1）
采用【智能三级匹配】方案：

预置颜色字典匹配（自动维护增量）
括号内容强制提取（最高优先级）为图案
剩余文本分析：
含特定后缀（如"色"）优先作为颜色
否则作为图案并触发标准化
示例：
"雪花灰战马(骑士)" →
颜色："雪花灰"（字典匹配）
图案："骑士"（括号提取）
剔除："战马"

2.2 规格/备注分割（问题4.1-4.3）
实施【双模式解析】：
A) 正则优先模式：

预置规格模式：r"均码|[X]{1,2}F|\d{2,3}[A-Z]?|中国(码|号型[A-CY])"
示例："均码29.99" → 规格："均码"
B) 动态分隔检测：

智能识别数字/中文边界
示例："130韶华" → 规格："130"
异常处理机制
颜色缺失：记录日志并填充"无颜色"
规格冲突：中断处理并抛出"数据格式错误"
备注异常：保留原始文本并添加警告标记
扩展性设计
颜色字典热更新接口
规格正则动态加载
分隔符配置化管理

提取逻辑
提取数量→分割字段→仅从前段字段中提取颜色图案→提取完成后清空前端字段内容→仅从后段字段中提取规格→提取备注
还有更好的方案吗？
